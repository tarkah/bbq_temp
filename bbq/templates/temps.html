{% extends "layout.html" %}
{% block content %}
<div class="row justify-content-center mb-3">
<canvas id="myChart" height="150" ></canvas>
</div>
<div class="row justify-content-center">
<table class="table table-striped table-hover table-sm text-center">
  <thead>
    <tr>
      <th scope="col">Id</th>
      <th scope="col">Temp1</th>
      <th scope="col">Temp2</th>
      <th scope="col">Volts</th>
      <th scope="col">Time</th>
    </tr>
  </thead>
  <tbody>
    {% if temps %}
    {% for temp in temps|sort(attribute='id', reverse=True) %}
    <tr>
      <th scope="row">{{temp.sesssion_temp_id}}</td>
      <td>{{temp.temp_1}}</td>
      <td>{{temp.temp_2}}</td>
      <td>{{temp.volts}}</td>
      <td>{{temp.created_local.strftime('%H:%M:%S')}}</td>
    </tr>
    {% endfor %}
    {% endif %}
  </tbody>
</table>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.3/Chart.bundle.min.js"></script>
<script>
    var timeFormat = 'YYYY-MM-DD HH:mm:ss';
    var color = Chart.helpers.color;
    var ctx = document.getElementById('myChart').getContext('2d');
    var myChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: [{% for temp in temps %} "{{temp.created_local.strftime('%Y-%m-%d %H:%M:%S')}}", {% endfor %}],
            datasets: [{
                label: 'Temp 1',
                data: [{% for temp in temps %} "{{temp.temp_1}}", {% endfor %}],
                backgroundColor: color("rgb(255, 99, 132)").alpha(0.5).rgbString(),
					      borderColor: "rgb(255, 99, 132)",
					      fill: false              
                    }, {
              label: 'Temp 2',
                data: [{% for temp in temps %} "{{temp.temp_2}}", {% endfor %}],                
                backgroundColor: color("rgb(54, 162, 235)").alpha(0.5).rgbString(),
					      borderColor: "rgb(54, 162, 235)",
					      fill: false 
            }]
        },
        options: {
          scales: {
					  xAxes: [{
  						type: 'time',
						  time: {
  							parser: timeFormat,
							  // round: 'day'
							  tooltipFormat: 'HH:mm:ss',
                displayFormats: {
                        quarter: 'HH:mm:ss'
                }
						  },
              ticks: {
                source: 'auto'
              },
						  scaleLabel: {
  							display: false,
							  labelString: 'Date'
						  }
					  }],
					  yAxes: [{
  						scaleLabel: {
							  display: false,
							  labelString: 'value'
						  }
					  }]
				  }
        }
    });
    </script>
{% endblock %}